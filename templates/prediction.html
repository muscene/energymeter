<!DOCTYPE html>
<html>
<head>
    <title>Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.3/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-blue-900 text-white font-sans">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">Payment Prediction</h1>
        <div class="bg-white p-6 rounded-lg shadow-md text-black">
            <label for="serial_number" class="block text-lg font-medium mb-2">Serial Number:</label>
            <input type="text" id="serial_number" class="w-full p-2 border rounded text-black focus:ring-2 focus:ring-blue-500" required>
            <button id="predictButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4 transition duration-300">Predict</button>
            <div id="predictionResult" class="mt-4 text-lg"></div>
            <div id="predictionError" class="mt-4 text-red-500"></div>
        </div>
    </div>

    <script>
        const apiBaseUrl = 'http://172.25.31.124:5000'; // **Correct URL**

        document.getElementById('predictButton').addEventListener('click', () => {
            const serialNumber = document.getElementById('serial_number').value;
            const predictionResultDiv = document.getElementById('predictionResult');
            const predictionErrorDiv = document.getElementById('predictionError');

            predictionResultDiv.textContent = "";
            predictionErrorDiv.textContent = "";

            console.log("Making request to:", `${apiBaseUrl}/predictx`); // **DEBUG**

            axios.post(`${apiBaseUrl}/predictx`, { serial_number: serialNumber })
                .then(response => {
                    console.log("Response:", response.data); // **DEBUG**
                    const predictedPayment = response.data.predicted_payment;
                    predictionResultDiv.textContent = `Predicted Payment: ${predictedPayment}`;
                })
                .catch(error => {
                    console.error("Prediction Error:", error); // Keep this for detailed errors
                    if (error.response) {
                        console.error("Response Data:", error.response.data); // **DEBUG**
                        predictionErrorDiv.textContent = `Error: ${error.response.data.error || "An error occurred."}`;
                    } else if (error.request) {
                        console.error("Request:", error.request); // **DEBUG**
                        predictionErrorDiv.textContent = "Error: No response received from the server.";
                    } else {
                        predictionErrorDiv.textContent = `Error: ${error.message || "A general error occurred."}`; // **DEBUG**
                    }
                });
        });
    </script>
</body>
</html>
